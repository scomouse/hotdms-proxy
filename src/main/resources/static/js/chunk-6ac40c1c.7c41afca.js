(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ac40c1c"],{"18fd":function(e,t,a){},3743:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper",staticStyle:{height:"3rem"}},[a("span",{staticClass:"table-title",staticStyle:{float:"left"}},[e._v(" 计划任务 ")]),a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"right"}},[a("a-button",{staticStyle:{"margin-left":"0.5rem"},attrs:{icon:"close"},on:{click:function(t){return e.handleBatchDelete()}}},[e._v("删除")]),a("a-button",{staticStyle:{"margin-left":"0.5rem"},attrs:{icon:"add"},on:{click:function(t){return e.handleAdd()}}},[e._v("添加")])],1)]),a("s-table",{ref:"table",attrs:{bordered:"true",size:"default",columns:e.columns,data:e.loadData,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange,getCheckboxProps:e.onCheckboxProps}},scopedSlots:e._u([{key:"status",fn:function(t,n){return["0"==n.status?a("span",[a("a",{staticStyle:{color:"green"}},[e._v("启用")])]):e._e(),"1"==n.status?a("span",[a("a",{staticStyle:{color:"red"}},[e._v("禁用")])]):e._e()]}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.handleEdit(n)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")])],1)}}])}),a("task-modal",{ref:"modal",on:{ok:e.handleSaveOk,close:e.handleSaveClose}})],1)},s=[],o=(a("d81d"),a("a15b"),a("b0c0"),a("2af9")),i=a("b775"),r={taskList:"/schedule/list",taskAdd:"/schedule/add",taskEdit:"/schedule/modify",taskDelete:"/schedule/remove"};function l(e){return Object(i["b"])({url:r.taskList,method:"get",params:e})}function c(e,t){return Object(i["b"])({url:"add"==t?r.taskAdd:r.taskEdit,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(e){return Object(i["b"])({url:r.taskDelete,method:"get",params:e})}var u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:600,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{staticClass:"ant-custom-edit-form",attrs:{form:e.form,layout:"inline"}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"任务名称",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{}],expression:"['name', {}]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"任务代号",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["alias",{}],expression:"['alias', {}]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"任务类名",labelCol:{span:3},wrapperCol:{span:21}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["beanName",{}],expression:"['beanName', {}]"}]})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"执行时间",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["cronExp",{}],expression:"['cronExp', {}]"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"记录日志",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["needLog",{}],expression:"['needLog', {}]"}]},[a("a-radio",{attrs:{value:"true"}},[e._v("是")]),a("a-radio",{attrs:{value:"false"}},[e._v("否")])],1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"状态",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{}],expression:"['status', {}]"}]},[a("a-radio",{attrs:{value:"0"}},[e._v("正常")]),a("a-radio",{attrs:{value:"1"}},[e._v("停用")])],1)],1)],1)],1)],1)],1)],1)},f=[],m=a("5530"),h=(a("d3b7"),{name:"TaskModal",data:function(){return{labelCol:{span:8},wrapperCol:{span:16},visible:!1,title:"",confirmLoading:!1,isEdit:!1}},beforeCreate:function(){this.form=this.$form.createForm(this)},created:function(){},methods:{add:function(){this.edit({id:"",name:"",alias:"",beanName:"",cronExp:"",status:"0",needLog:"false"}),this.title="添加计划任务",this.action="add",this.isEdit=!1},edit:function(e){var t=this;this.title="修改计划任务",this.action="edit",this.visible=!0,this.isEdit=!0,this.$nextTick((function(){t.form.setFieldsValue(Object(m["a"])({},e))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this;this.form.validateFields((function(t,a){t||(e.confirmLoading=!0,new Promise((function(e){setTimeout((function(){return e()}),2e3)})).then((function(){e.$emit("ok")})).catch((function(){})).finally((function(){e.confirmLoading=!1,e.close()})))}))},handleCancel:function(){this.close()}}}),p=h,v=(a("934e"),a("2877")),b=Object(v["a"])(p,u,f,!1,null,null,null),g=b.exports,k={name:"TaskList",components:{STable:o["b"],TaskModal:g},data:function(){var e=this;return{visible:!1,form:null,mdl:{},advanced:!1,queryParam:{},columns:[{title:"序号",dataIndex:"no"},{title:"任务名称",dataIndex:"name"},{title:"任务代号",dataIndex:"alias"},{title:"任务类名",dataIndex:"beanName"},{title:"执行时间(cron表达式)",dataIndex:"cronExp"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"是否记录日志",dataIndex:"needLog",customRender:function(e){return"1"==e?"是":"否"}},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){var a=Object.assign({},t,e.queryParam);return l(a).then((function(e){return e.data.list.map((function(e,t){e.no=t+1})),{pageSize:e.data.pageSize,pageNo:e.data.pageNo,totalCount:e.data.totalCount,totalPage:e.data.totalCount/e.data.pageSize+1,data:e.data.list}}))},selectedRowKeys:[],selectedRows:[]}},created:function(){},methods:{handleAdd:function(){this.editItem=null,this.$refs.modal.add()},handleEdit:function(e){this.editItem=e,this.$refs.modal.edit(e)},handleSaveOk:function(){var e=this,t=this.$refs.modal.form.getFieldsValue();this.editItem&&(t.id=this.editItem.id),c(t,this.$refs.modal.action).then((function(t){e.$message.success("保存成功"),e.$refs.table.refresh(!0)}))},handleSaveClose:function(){},handleBatchDelete:function(){var e=[];this.selectedRows.map((function(t){e.push(t.id)})),this.callDeleteTask(e.join(","),"您将删除选择的"+e.length+"个计划任务，请确认是否继续 ?")},handleDelete:function(e){this.callDeleteTask(e.id,"您将删除计划任务【"+e.name+"】，请确认是否继续 ?")},callDeleteTask:function(e,t){var a=this;this.$confirm({title:"提示",content:t,onOk:function(){return d({taskids:e}).then((function(e){"SUCCESS"==e.code?(a.$message.success("删除成功"),a.$refs.table.refresh(!0)):a.$message.error(e.message)}))}})},onChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onCheckboxProps:function(e){return{props:{name:e.id}}}}},w=k,C=(a("be6c"),Object(v["a"])(w,n,s,!1,null,null,null));t["default"]=C.exports},"934e":function(e,t,a){"use strict";a("df9d")},be6c:function(e,t,a){"use strict";a("18fd")},df9d:function(e,t,a){}}]);